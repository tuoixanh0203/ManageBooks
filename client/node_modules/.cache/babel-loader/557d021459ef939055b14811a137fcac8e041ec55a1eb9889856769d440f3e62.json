{"ast":null,"code":"/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar _ = require('./util');\n\n/**\n * 解析style\n *\n * @param {String} css\n * @param {Function} onAttr 处理属性的函数\n *   参数格式： function (sourcePosition, position, name, value, source)\n * @return {String}\n */\nfunction parseStyle(css, onAttr) {\n  css = _.trimRight(css);\n  if (css[css.length - 1] !== ';') css += ';';\n  var cssLength = css.length;\n  var isParenthesisOpen = false;\n  var lastPos = 0;\n  var i = 0;\n  var retCSS = '';\n  function addNewAttr() {\n    // 如果没有正常的闭合圆括号，则直接忽略当前属性\n    if (!isParenthesisOpen) {\n      var source = _.trim(css.slice(lastPos, i));\n      var j = source.indexOf(':');\n      if (j !== -1) {\n        var name = _.trim(source.slice(0, j));\n        var value = _.trim(source.slice(j + 1));\n        // 必须有属性名称\n        if (name) {\n          var ret = onAttr(lastPos, retCSS.length, name, value, source);\n          if (ret) retCSS += ret + '; ';\n        }\n      }\n    }\n    lastPos = i + 1;\n  }\n  for (; i < cssLength; i++) {\n    var c = css[i];\n    if (c === '/' && css[i + 1] === '*') {\n      // 备注开始\n      var j = css.indexOf('*/', i + 2);\n      // 如果没有正常的备注结束，则后面的部分全部跳过\n      if (j === -1) break;\n      // 直接将当前位置调到备注结尾，并且初始化状态\n      i = j + 1;\n      lastPos = i + 1;\n      isParenthesisOpen = false;\n    } else if (c === '(') {\n      isParenthesisOpen = true;\n    } else if (c === ')') {\n      isParenthesisOpen = false;\n    } else if (c === ';') {\n      if (isParenthesisOpen) {\n        // 在圆括号里面，忽略\n      } else {\n        addNewAttr();\n      }\n    } else if (c === '\\n') {\n      addNewAttr();\n    }\n  }\n  return _.trim(retCSS);\n}\nmodule.exports = parseStyle;","map":{"version":3,"names":["_","require","parseStyle","css","onAttr","trimRight","length","cssLength","isParenthesisOpen","lastPos","i","retCSS","addNewAttr","source","trim","slice","j","indexOf","name","value","ret","c","module","exports"],"sources":["C:/Users/Admin/Documents/Web/GRAPHQL/node_modules/cssfilter/lib/parser.js"],"sourcesContent":["/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar _ = require('./util');\n\n\n/**\n * 解析style\n *\n * @param {String} css\n * @param {Function} onAttr 处理属性的函数\n *   参数格式： function (sourcePosition, position, name, value, source)\n * @return {String}\n */\nfunction parseStyle (css, onAttr) {\n  css = _.trimRight(css);\n  if (css[css.length - 1] !== ';') css += ';';\n  var cssLength = css.length;\n  var isParenthesisOpen = false;\n  var lastPos = 0;\n  var i = 0;\n  var retCSS = '';\n\n  function addNewAttr () {\n    // 如果没有正常的闭合圆括号，则直接忽略当前属性\n    if (!isParenthesisOpen) {\n      var source = _.trim(css.slice(lastPos, i));\n      var j = source.indexOf(':');\n      if (j !== -1) {\n        var name = _.trim(source.slice(0, j));\n        var value = _.trim(source.slice(j + 1));\n        // 必须有属性名称\n        if (name) {\n          var ret = onAttr(lastPos, retCSS.length, name, value, source);\n          if (ret) retCSS += ret + '; ';\n        }\n      }\n    }\n    lastPos = i + 1;\n  }\n\n  for (; i < cssLength; i++) {\n    var c = css[i];\n    if (c === '/' && css[i + 1] === '*') {\n      // 备注开始\n      var j = css.indexOf('*/', i + 2);\n      // 如果没有正常的备注结束，则后面的部分全部跳过\n      if (j === -1) break;\n      // 直接将当前位置调到备注结尾，并且初始化状态\n      i = j + 1;\n      lastPos = i + 1;\n      isParenthesisOpen = false;\n    } else if (c === '(') {\n      isParenthesisOpen = true;\n    } else if (c === ')') {\n      isParenthesisOpen = false;\n    } else if (c === ';') {\n      if (isParenthesisOpen) {\n        // 在圆括号里面，忽略\n      } else {\n        addNewAttr();\n      }\n    } else if (c === '\\n') {\n      addNewAttr();\n    }\n  }\n\n  return _.trim(retCSS);\n}\n\nmodule.exports = parseStyle;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;;AAGzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,UAAU,CAAEC,GAAG,EAAEC,MAAM,EAAE;EAChCD,GAAG,GAAGH,CAAC,CAACK,SAAS,CAACF,GAAG,CAAC;EACtB,IAAIA,GAAG,CAACA,GAAG,CAACG,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,EAAEH,GAAG,IAAI,GAAG;EAC3C,IAAII,SAAS,GAAGJ,GAAG,CAACG,MAAM;EAC1B,IAAIE,iBAAiB,GAAG,KAAK;EAC7B,IAAIC,OAAO,GAAG,CAAC;EACf,IAAIC,CAAC,GAAG,CAAC;EACT,IAAIC,MAAM,GAAG,EAAE;EAEf,SAASC,UAAU,GAAI;IACrB;IACA,IAAI,CAACJ,iBAAiB,EAAE;MACtB,IAAIK,MAAM,GAAGb,CAAC,CAACc,IAAI,CAACX,GAAG,CAACY,KAAK,CAACN,OAAO,EAAEC,CAAC,CAAC,CAAC;MAC1C,IAAIM,CAAC,GAAGH,MAAM,CAACI,OAAO,CAAC,GAAG,CAAC;MAC3B,IAAID,CAAC,KAAK,CAAC,CAAC,EAAE;QACZ,IAAIE,IAAI,GAAGlB,CAAC,CAACc,IAAI,CAACD,MAAM,CAACE,KAAK,CAAC,CAAC,EAAEC,CAAC,CAAC,CAAC;QACrC,IAAIG,KAAK,GAAGnB,CAAC,CAACc,IAAI,CAACD,MAAM,CAACE,KAAK,CAACC,CAAC,GAAG,CAAC,CAAC,CAAC;QACvC;QACA,IAAIE,IAAI,EAAE;UACR,IAAIE,GAAG,GAAGhB,MAAM,CAACK,OAAO,EAAEE,MAAM,CAACL,MAAM,EAAEY,IAAI,EAAEC,KAAK,EAAEN,MAAM,CAAC;UAC7D,IAAIO,GAAG,EAAET,MAAM,IAAIS,GAAG,GAAG,IAAI;QAC/B;MACF;IACF;IACAX,OAAO,GAAGC,CAAC,GAAG,CAAC;EACjB;EAEA,OAAOA,CAAC,GAAGH,SAAS,EAAEG,CAAC,EAAE,EAAE;IACzB,IAAIW,CAAC,GAAGlB,GAAG,CAACO,CAAC,CAAC;IACd,IAAIW,CAAC,KAAK,GAAG,IAAIlB,GAAG,CAACO,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,EAAE;MACnC;MACA,IAAIM,CAAC,GAAGb,GAAG,CAACc,OAAO,CAAC,IAAI,EAAEP,CAAC,GAAG,CAAC,CAAC;MAChC;MACA,IAAIM,CAAC,KAAK,CAAC,CAAC,EAAE;MACd;MACAN,CAAC,GAAGM,CAAC,GAAG,CAAC;MACTP,OAAO,GAAGC,CAAC,GAAG,CAAC;MACfF,iBAAiB,GAAG,KAAK;IAC3B,CAAC,MAAM,IAAIa,CAAC,KAAK,GAAG,EAAE;MACpBb,iBAAiB,GAAG,IAAI;IAC1B,CAAC,MAAM,IAAIa,CAAC,KAAK,GAAG,EAAE;MACpBb,iBAAiB,GAAG,KAAK;IAC3B,CAAC,MAAM,IAAIa,CAAC,KAAK,GAAG,EAAE;MACpB,IAAIb,iBAAiB,EAAE;QACrB;MAAA,CACD,MAAM;QACLI,UAAU,EAAE;MACd;IACF,CAAC,MAAM,IAAIS,CAAC,KAAK,IAAI,EAAE;MACrBT,UAAU,EAAE;IACd;EACF;EAEA,OAAOZ,CAAC,CAACc,IAAI,CAACH,MAAM,CAAC;AACvB;AAEAW,MAAM,CAACC,OAAO,GAAGrB,UAAU"},"metadata":{},"sourceType":"script","externalDependencies":[]}