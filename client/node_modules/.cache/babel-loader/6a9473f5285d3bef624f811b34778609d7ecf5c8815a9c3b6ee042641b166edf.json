{"ast":null,"code":"/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar DEFAULT = require('./default');\nvar parseStyle = require('./parser');\nvar _ = require('./util');\n\n/**\n * 返回值是否为空\n *\n * @param {Object} obj\n * @return {Boolean}\n */\nfunction isNull(obj) {\n  return obj === undefined || obj === null;\n}\n\n/**\n * 浅拷贝对象\n *\n * @param {Object} obj\n * @return {Object}\n */\nfunction shallowCopyObject(obj) {\n  var ret = {};\n  for (var i in obj) {\n    ret[i] = obj[i];\n  }\n  return ret;\n}\n\n/**\n * 创建CSS过滤器\n *\n * @param {Object} options\n *   - {Object} whiteList\n *   - {Function} onAttr\n *   - {Function} onIgnoreAttr\n *   - {Function} safeAttrValue\n */\nfunction FilterCSS(options) {\n  options = shallowCopyObject(options || {});\n  options.whiteList = options.whiteList || DEFAULT.whiteList;\n  options.onAttr = options.onAttr || DEFAULT.onAttr;\n  options.onIgnoreAttr = options.onIgnoreAttr || DEFAULT.onIgnoreAttr;\n  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;\n  this.options = options;\n}\nFilterCSS.prototype.process = function (css) {\n  // 兼容各种奇葩输入\n  css = css || '';\n  css = css.toString();\n  if (!css) return '';\n  var me = this;\n  var options = me.options;\n  var whiteList = options.whiteList;\n  var onAttr = options.onAttr;\n  var onIgnoreAttr = options.onIgnoreAttr;\n  var safeAttrValue = options.safeAttrValue;\n  var retCSS = parseStyle(css, function (sourcePosition, position, name, value, source) {\n    var check = whiteList[name];\n    var isWhite = false;\n    if (check === true) isWhite = check;else if (typeof check === 'function') isWhite = check(value);else if (check instanceof RegExp) isWhite = check.test(value);\n    if (isWhite !== true) isWhite = false;\n\n    // 如果过滤后 value 为空则直接忽略\n    value = safeAttrValue(name, value);\n    if (!value) return;\n    var opts = {\n      position: position,\n      sourcePosition: sourcePosition,\n      source: source,\n      isWhite: isWhite\n    };\n    if (isWhite) {\n      var ret = onAttr(name, value, opts);\n      if (isNull(ret)) {\n        return name + ':' + value;\n      } else {\n        return ret;\n      }\n    } else {\n      var ret = onIgnoreAttr(name, value, opts);\n      if (!isNull(ret)) {\n        return ret;\n      }\n    }\n  });\n  return retCSS;\n};\nmodule.exports = FilterCSS;","map":{"version":3,"names":["DEFAULT","require","parseStyle","_","isNull","obj","undefined","shallowCopyObject","ret","i","FilterCSS","options","whiteList","onAttr","onIgnoreAttr","safeAttrValue","prototype","process","css","toString","me","retCSS","sourcePosition","position","name","value","source","check","isWhite","RegExp","test","opts","module","exports"],"sources":["C:/Users/Admin/Documents/Web/GRAPHQL/node_modules/cssfilter/lib/css.js"],"sourcesContent":["/**\n * cssfilter\n *\n * @author 老雷<leizongmin@gmail.com>\n */\n\nvar DEFAULT = require('./default');\nvar parseStyle = require('./parser');\nvar _ = require('./util');\n\n\n/**\n * 返回值是否为空\n *\n * @param {Object} obj\n * @return {Boolean}\n */\nfunction isNull (obj) {\n  return (obj === undefined || obj === null);\n}\n\n/**\n * 浅拷贝对象\n *\n * @param {Object} obj\n * @return {Object}\n */\nfunction shallowCopyObject (obj) {\n  var ret = {};\n  for (var i in obj) {\n    ret[i] = obj[i];\n  }\n  return ret;\n}\n\n/**\n * 创建CSS过滤器\n *\n * @param {Object} options\n *   - {Object} whiteList\n *   - {Function} onAttr\n *   - {Function} onIgnoreAttr\n *   - {Function} safeAttrValue\n */\nfunction FilterCSS (options) {\n  options = shallowCopyObject(options || {});\n  options.whiteList = options.whiteList || DEFAULT.whiteList;\n  options.onAttr = options.onAttr || DEFAULT.onAttr;\n  options.onIgnoreAttr = options.onIgnoreAttr || DEFAULT.onIgnoreAttr;\n  options.safeAttrValue = options.safeAttrValue || DEFAULT.safeAttrValue;\n  this.options = options;\n}\n\nFilterCSS.prototype.process = function (css) {\n  // 兼容各种奇葩输入\n  css = css || '';\n  css = css.toString();\n  if (!css) return '';\n\n  var me = this;\n  var options = me.options;\n  var whiteList = options.whiteList;\n  var onAttr = options.onAttr;\n  var onIgnoreAttr = options.onIgnoreAttr;\n  var safeAttrValue = options.safeAttrValue;\n\n  var retCSS = parseStyle(css, function (sourcePosition, position, name, value, source) {\n\n    var check = whiteList[name];\n    var isWhite = false;\n    if (check === true) isWhite = check;\n    else if (typeof check === 'function') isWhite = check(value);\n    else if (check instanceof RegExp) isWhite = check.test(value);\n    if (isWhite !== true) isWhite = false;\n\n    // 如果过滤后 value 为空则直接忽略\n    value = safeAttrValue(name, value);\n    if (!value) return;\n\n    var opts = {\n      position: position,\n      sourcePosition: sourcePosition,\n      source: source,\n      isWhite: isWhite\n    };\n\n    if (isWhite) {\n\n      var ret = onAttr(name, value, opts);\n      if (isNull(ret)) {\n        return name + ':' + value;\n      } else {\n        return ret;\n      }\n\n    } else {\n\n      var ret = onIgnoreAttr(name, value, opts);\n      if (!isNull(ret)) {\n        return ret;\n      }\n\n    }\n  });\n\n  return retCSS;\n};\n\n\nmodule.exports = FilterCSS;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}